generalized_tables:
# etldoc: osm_railway_linestring_gen_z5 -> osm_railway_linestring_gen_z4
  railway_linestring_gen_z4:
    source: railway_linestring_gen_z5
    tolerance: ZRES5

# etldoc: osm_railway_linestring_gen_z6 -> osm_railway_linestring_gen_z5
  railway_linestring_gen_z5:
    source: railway_linestring_gen_z6
    tolerance: ZRES6

# etldoc: osm_railway_linestring_gen_z7 -> osm_railway_linestring_gen_z6
  railway_linestring_gen_z6:
    source: railway_linestring_gen_z7
    tolerance: ZRES7

# etldoc: osm_railway_linestring_gen_z8 -> osm_railway_linestring_gen_z7
  railway_linestring_gen_z7:
    source: railway_linestring_gen_z8
    sql_filter: usage='main'
    tolerance: ZRES8

# etldoc: osm_railway_linestring_gen_z9 -> osm_railway_linestring_gen_z8
  railway_linestring_gen_z8:
    source: railway_linestring_gen_z9
    sql_filter: railway NOT IN ('disused', 'abandoned', 'razed', 'proposed', 'construction')
    tolerance: ZRES9

# etldoc: osm_railway_linestring_gen_z10 -> osm_railway_linestring_gen_z9
  railway_linestring_gen_z9:
    source: railway_linestring_gen_z10
    sql_filter: usage IN ('main', 'branch')
    tolerance: ZRES10

# etldoc: osm_railway_linestring_gen_z11 -> osm_railway_linestring_gen_z10
  railway_linestring_gen_z10:
    source: railway_linestring_gen_z11
    sql_filter: railway IS NOT 'tram' AND service=''
    tolerance: ZRES11

# etldoc: osm_railway_linestring_gen_z12 -> osm_railway_linestring_gen_z11
  railway_linestring_gen_z11:
    source: railway_linestring_gen_z12
    sql_filter: railway IN ('rail', 'narrow_gauge', 'light_rail', 'tram')
    tolerance: ZRES12

# etldoc: osm_railway_linestring -> osm_railway_linestring_gen_z12
  railway_linestring_gen_z12:
    source: railway_linestring
    sql_filter: ST_IsValid(geometry)
    tolerance: ZRES13

tables:
# etldoc: imposm3 -> osm_railway_linestring
  railway_linestring:
    type: linestring
    _resolve_wikidata: false
    columns:
    - name: osm_id
      type: id
    - name: geometry
      type: geometry
    - key: railway
      name: railway
      type: string
    - key: ref
      name: ref
      type: string
    - key: railway:track_ref
      name: track_ref
      type: string
    - name: z_order
      type: wayzorder
    - key: layer
      name: layer
      type: integer
    - name: name
      key: name
      type: string
    - name: name_en
      key: name:en
      type: string
    - name: name_de
      key: name:de
      type: string
    - name: tags
      type: hstore_tags
    - key: short_name
      name: short_name
      type: string
    - key: tunnel
      name: is_tunnel
      type: bool
    - key: bridge
      name: is_bridge
      type: bool
    - name: is_area
      key: area
      type: bool
    - key: service
      name: service
      type: string
    - key: usage
      name: usage
      type: string
    mapping:
      railway:
      - rail
      - narrow_gauge
      - light_rail
      - subway
      - tram
      - disused
      - abandoned
      - razed
      - proposed
      - construction
